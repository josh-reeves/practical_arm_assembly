<!DOCTYPE html>
<html>
    <head>
        <title>Practical ARM Assembly Notes</title>
        <link rel="stylesheet" href="/practical_arm_assembly/assets/styles/default-styles.css">    
        <script src="/practical_arm_assembly/assets/components/components.js" type="module"></script>
        <script src="/practical_arm_assembly/assets/scripts/eventListeners.js"></script>
        <script src="/practical_arm_assembly/assets/scripts/utils.js"></script>
    </head>

    <body>
        <page-header></page-header>

        <nav-menu></nav-menu>

        <main>
            <details class="content-container" open>
                <summary><p>Loops</p><div><button class="a32-toggle inactive">A32</button><button class="a64-toggle">A64</button></div></summary>
                <p>The previous section explored how the Branch instruction can be used for conditional execution. In addition to conditional statements, this can also be used to create loops. The below implements a simple while-loop with the Branch instruction:</p>
                <div class="a32-content">
                    <div class="illustration codebox">
                        <copy-button></copy-button>
                        <p>_start:</p>
                        <p class="indented">mov r0, #0x0</p>
                        <br>
                        <p class="indented">loop:</p>
                        <p class="indentedx2">cmp r0, #0x5</p>
                        <p class="indentedx2">bge exit</p>
                        <br>
                        <p class="indentedx2">add r0, r0, #0x1</p>
                        <p class="indentedx2">b loop</p>
                        <br>
                        <p class="indented">exit:</p>
                        <p class="indentedx2">mov r7, #0x1</p>
                        <p class="indentedx2">svc 0</p>
                    </div>
                    <p>The program begins by moving the value 0 into register r0. comparing the value stored in r0 to 5. The following line pairs the Branch instruction with the Greater than or Equal to (ge) mnemonic extension to restrict execution of the instruction based on the results of the previous comparison. If the value stored in r0 is greater than or equal to 5, execution will branch to the exit label and the program will end. Otherwise, 1 is added to the value currently stored in r0 and execution branches back to the beginning of the loop label. This is roughly equivalent to the following code in C:</p>    
                </div>

                <div class="a64-content">
                    <div class="illustration codebox">
                        <copy-button></copy-button>
                        <p>_start:</p>
                        <p class="indented">mov x0, #0x0</p>
                        <br>
                        <p class="indented">loop:</p>
                        <p class="indentedx2">cmp x0, #0x5</p>
                        <p class="indentedx2">bge exit</p>
                        <br>
                        <p class="indentedx2">add x0, x0, #0x1</p>
                        <p class="indentedx2">b loop</p>
                        <br>
                        <p class="indented">exit:</p>
                        <p class="indentedx2">mov x8, #0x5d</p>
                        <p class="indentedx2">svc 0</p>
                    </div>
                    <p>The program begins by moving the value 0 into register x0. comparing the value stored in x0 to 5. The following line pairs the Branch instruction with the Greater than or Equal to (ge) mnemonic extension to restrict execution of the instruction based on the results of the previous comparison. If the value stored in x0 is greater than or equal to 5, execution will branch to the exit label and the program will end. Otherwise, 1 is added to the value currently stored in x0 and execution branches back to the beginning of the loop label. This is roughly equivalent to the following code in C:</p>    
                </div>
                <div class="illustration codebox">
                    <copy-button></copy-button>
                    <p>int i = 0;</p>
                    <br>
                    <p>while (i < 5)</p>
                    <p>{</p>
                    <p class="indented">i++;</p>
                    <br>
                    <p>}</p>
                    <br>
                    <p>return i;</p>
                </div>
            </details>

            <details class="content-container" open>
                <summary><p>Summary</p><div><button class="a32-toggle inactive">A32</button><button class="a64-toggle">A64</button></div></summary>
                <p>In addition to conditional logic, the branch statement can be used to implement loops.</p>
                <h3>Examples</h3>
                <div class="a32-content">
                    <ul>
                        <li><a href="https://github.com/josh-reeves/practical_arm_assembly/blob/main/source/section-09/a32/while-loop.s">While Loop</a></li>
                    </ul>
                </div>

                <div class="a64-content">
                    <ul>
                        <li><a href="https://github.com/josh-reeves/practical_arm_assembly/blob/main/source/section-09/a64/while-loop.s">While Loop</a></li>
                    </ul>
                </div>
            </details>
            <hr class="page-end"/>
            <nav-button href="/practical_arm_assembly/pages/notes/section-08/branching.html" class="prev">Section 08: Branching</nav-button>      
            <nav-button href="/practical_arm_assembly/pages/notes/section-10/function-calls.html" class="next">Section 10: Function Calls</nav-button>
        </main>
    </body>
</html>
